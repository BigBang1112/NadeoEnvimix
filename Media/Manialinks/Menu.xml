<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<manialink version="3">
	<frame pos="160 -88" id="tooltip" hidden="1">
		<quad pos="0 0" z-index="0" size="280 6" bgcolor="222A" valign="bottom" halign="right"/>
		<label pos="-270 3" z-index="1" size="260 6" text="Play Nadeo maps with any car of your wish. Combinations are endless." valign="center2" style="TextTitle3" textsize="1"/>
	</frame>
	<frame id="menu" hidden="1">
		<quad pos="55 20" z-index="1" size="8 8" bgcolor="FFFA" halign="center" valign="center" style="UIConstruction_Buttons" substyle="Help" scriptevents="1" id="help"/>
		<quad pos="0 5" z-index="0" size="120 120" halign="center" valign="center" scriptevents="1" id="block" hidden="1"/>
		<quad pos="0 45" z-index="0" size="120 40" image="file://Media/Images/NadeoEnvimix2.png" halign="center" valign="center" manialink="nadeoenvimix" id="logo"/>
		<frame pos="0 -52" id="footer" scale="1">
			<quad z-index="0" size="110 6" bgcolor="0008" valign="center" halign="center" pos="0 -3"/>
			<label z-index="1" size="110 6" text="Made by $iBigBang1112 & Poutrel" valign="center2" textsize="1" halign="center" style="TextButtonBig" pos="0 -3" scriptevents="1"/>
		</frame>
		<quad pos="0 -15" z-index="-1" size="110 70" bgcolor="0008" halign="center" valign="center"/>
		<frame id="buttons">
			<frame pos="0 5" id="buttonPlay">
				<quad pos="0 0" z-index="0" size="100 20" bgcolor="000" halign="center" valign="center" scriptevents="1" opacity=".9" id="button"/>
				<label pos="0 0" z-index="1" size="100 20" text="Play" halign="center" valign="center2" style="TextTitle3" textsize="8" id="text"/>
			</frame>
			<frame pos="-26 -12" id="buttonStatistics">
				<quad pos="0 0" z-index="0" size="48 10" bgcolor="000" halign="center" valign="center" scriptevents="1" opacity=".9" id="button"/>
				<label pos="0 0" z-index="1" size="48 10" text="Statistics" halign="center" valign="center2" style="TextTitle3" textsize="2" id="text"/>
			</frame>
			<frame pos="-26 -24" id="buttonProfile">
				<quad pos="0 0" z-index="0" size="48 10" bgcolor="000" halign="center" valign="center" scriptevents="1" opacity=".9" id="button"/>
				<label pos="0 0" z-index="1" size="48 10" text="Profile" halign="center" valign="center2" style="TextTitle3" textsize="2" id="text"/>
			</frame>
			<frame pos="-26 -40" id="buttonExit">
				<quad pos="0 0" z-index="0" size="48 10" bgcolor="000" halign="center" valign="center" scriptevents="1" opacity=".9" id="button" action="exit"/>
				<label pos="0 0" z-index="1" size="48 10" text="Exit" halign="center" valign="center2" style="TextTitle3" textsize="2" id="text"/>
			</frame>
			<frame pos="25 -26" id="buttonTrack">
				<quad z-index="0" size="50 38" bgcolor="000F" scriptevents="1" opacity=".9" id="button" halign="center" valign="center" pos="0 0"/>
				<label pos="0 14" z-index="1" size="50 10" text="Track of the Day" style="TextTitle3" halign="center" valign="center2" textsize="1" id="text"/>
				<frame z-index="1" scale="1.05" id="track">
					<quad pos="0 9" size="50 25" halign="center" image="file://Media/Thumbnails/Loading.jpg" id="thumbnail"/>
					<label pos="-22 -14" z-index="1" size="45 5" text="Lagoon D15" valign="bottom" style="TextTitle3" textsize="2" id="name"/>
				</frame>
			</frame>
		</frame>
	</frame>
	<frame id="selection" z-index="1">
		<quad pos="-160 89.8" z-index="-1" size="320 180" scriptevents="1"/>
		<quad pos="-140 70" z-index="0" size="3 140" bgcolor="444A"/>
		<quad pos="88 70" z-index="0" size="49 12.5" bgcolor="444A"/>
		<quad pos="88 57.5" z-index="0" size="49 127.5" bgcolor="000A"/>
		<quad pos="-137 57.5" z-index="0" size="217 127.5" bgcolor="000A"/>
		<quad pos="-137 70" z-index="0" size="217 12.5" bgcolor="444A"/>
		<quad pos="80 70" z-index="0" size="3 140" bgcolor="444A"/>
		<quad pos="83 60" z-index="0" size="2 30" bgcolor="000A"/>
		<quad pos="85 70" z-index="0" size="3 140" bgcolor="444A"/>
		<quad pos="137 70" z-index="0" size="3 140" bgcolor="444A"/>
		
		<quad pos="140 70" z-index="1" size="10 10" bgcolor="FFFA" id="help" halign="center" valign="center" style="UIConstruction_Buttons" substyle="Help" scriptevents="1"/>
		
		<frame pos="-130 63.5" z-index="1">
			<label pos="0 0.5" z-index="0" size="40 10" text="Canyon" style="TextTitle3" textsize="3" valign="center" scale="1.25"/>
			
			<frame pos="145 0" id="buttonMostInteresting">
				<quad pos="0 0" z-index="0" size="40 8" bgcolor="000" halign="center" valign="center" scriptevents="1" opacity=".9" id="button"/>
				<label pos="0 0" z-index="1" size="40 10" text="Most Interesting" halign="center" valign="center2" style="TextTitle3" textsize="1" id="text"/>
			</frame>
			<frame pos="190 0" id="buttonMostDifficult">
				<quad pos="0 0" z-index="0" size="40 8" bgcolor="000" halign="center" valign="center" scriptevents="1" opacity=".9" id="button"/>
				<label pos="0 0" z-index="1" size="40 10" text="Most Difficult" halign="center" valign="center2" style="TextTitle3" textsize="1" id="text"/>
			</frame>
		</frame>
		
		<frame pos="112.5 66" z-index="1">
			<label pos="0 0" z-index="0" size="45 5" text="Menu" style="TextTitle3" halign="center" textsize="4"/>
			<frame pos="0 -15">
				<quad z-index="0" size="49 10" bgcolor="111A" halign="center" valign="center"/>
				<label pos="0 0" z-index="1" size="49 10" text="Canyon" halign="center" valign="center2" style="TextTitle3" textsize="2"/>
			</frame>
			<frame pos="0 -25">
				<quad z-index="0" size="49 10" bgcolor="000A" halign="center" valign="center"/>
				<label pos="0 0" z-index="1" size="49 10" text="Stadium" halign="center" valign="center2" style="TextTitle3" textsize="2"/>
			</frame>
			<frame pos="0 -35">
				<quad z-index="0" size="49 10" bgcolor="111A" halign="center" valign="center"/>
				<label pos="0 0" z-index="1" size="49 10" text="Valley" halign="center" valign="center2" style="TextTitle3" textsize="2"/>
			</frame>
			<frame pos="0 -45">
				<quad z-index="0" size="49 10" bgcolor="000A" halign="center" valign="center"/>
				<label pos="0 0" z-index="1" size="49 10" text="Lagoon" halign="center" valign="center2" style="TextTitle3" textsize="2"/>
			</frame>
		</frame>
		
		<quad pos="-135 55" z-index="1" size="200 2" bgcolor="FFFF" opacity=".75" id="difficultyBar"/>
		
		<frame pos="-135 50" id="maps" z-index="1">
			<frame pos="20 -10">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A01" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="60 -10">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A02" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="100 -10">
				<quad  z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A03" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="140 -10">
				<quad  z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A04" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="180 -10">
				<quad  z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A05" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
				
			<frame pos="20 -30">
				<quad  z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" valign="center" halign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A06" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="60 -30">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" valign="center" halign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A07" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="100 -30">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" valign="center" halign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A08" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="140 -30">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A09" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="180 -30">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A10" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
				
			<frame pos="20 -50">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" valign="center" halign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A11" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="60 -50">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A12" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="100 -50">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A13" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="140 -50">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" valign="center" halign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A14" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
			<frame pos="180 -50">
				<quad z-index="1" size="41 21" bgcolor="FFFA" style="Bgs1" substyle="BgColorContour" id="select" hidden="1" halign="center" valign="center"/>
				<quad z-index="0" size="40 20" image="file://Media/Thumbnails/NoThumbnail.jpg" opacity=".9" halign="center" valign="center"/>
				<label pos="15 -7.5" z-index="1" size="20 10" text="A15" valign="bottom" style="TextTitle3" halign="right" textsize="4" id="name"/>
			</frame>
		</frame>
		
		<quad pos="-135 -15" z-index="1" size="200 50" bgcolor="000A"/>
		
		<quad pos="80 50" z-index="1" size="1 22" bgcolor="FFFC" halign="right"/>
		<quad pos="80 28" z-index="1" size="1 22" bgcolor="0F0C" halign="right"/>
		<quad pos="80 6" z-index="1" size="1 22" bgcolor="00FC" halign="right"/>
		<quad pos="80 -16" z-index="1" size="1 22" bgcolor="F00C" halign="right"/>
		<quad pos="80 -38" z-index="1" size="1 22" bgcolor="000C" halign="right"/>
		
		<frame pos="72.5 50" z-index="1" id="slider">
			<quad pos="0 5" z-index="0" size="10 120" bgcolor="000A" halign="center"/>
			<quad z-index="1" size="8 22" bgcolor="AAAA" halign="center" id="button" scriptevents="1" pos="0 0"/>
		</frame>
		
		<frame pos="112.5 -60" z-index="1" id="buttonBack">
			<quad pos="0 0" size="49 10" bgcolor="800" halign="center" valign="center" scriptevents="1" opacity=".9" id="button"/>
			<label pos="0 0" z-index="1" size="49 10" text="Back" halign="center" valign="center2" style="TextTitle3" textsize="2" id="text"/>
		</frame>
		
	</frame>
	<script>
	<!--
		#Include "TextLib" as TextLib
		#Include "MathLib" as MathLib
		#Include "AnimLib" as AnimLib
		
		declare Integer StartTime;
		declare CAudioSource SoundHover;
		declare CAudioSource SoundClick;
		declare CAudioSource SoundElectric;
		
		declare CHttpRequest TrackOfTheDayRequest;
		
		Boolean IsMenuShown() {
			return (Page.GetFirstChild("footer").RelativeScale == 1.0);
		}
		
		Void ShowMenu(Integer _StartTime) {
			Page.GetFirstChild("menu").Show();
		
			Page.GetFirstChild("logo").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime, 0.0, 1.0, 1000);
			Page.GetFirstChild("menu").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 100, 0.0, 1.0, 1000);
			Page.GetFirstChild("footer").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 200, 0.0, 1.0, 1000);
			
			Page.GetFirstChild("buttonPlay").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 300, 0.0, 1.0, 500);
			Page.GetFirstChild("buttonStatistics").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 400, 0.0, 1.0, 500);
			Page.GetFirstChild("buttonProfile").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 500, 0.0, 1.0, 500);
			Page.GetFirstChild("buttonExit").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 600, 0.0, 1.0, 500);
			Page.GetFirstChild("buttonTrack").RelativeScale = AnimLib::EaseOutCubic(Now - _StartTime - 400, 0.0, 1.0, 500);
			
			((Page.GetFirstChild("menu") as CMlFrame).GetFirstChild("help") as CMlQuad).Opacity = AnimLib::EaseOutCubic(Now - _StartTime - 1200, 0.0, 1.0, 500);
		}
		
		Integer HideMenu(Integer _StartTime, Text _Action) {
			declare Time = Now - _StartTime;
			
			if(Time > 0 && Time < 100)
				Page.GetFirstChild("menu").Hide();
			else if(Time > 150 && Time < 250)
				Page.GetFirstChild("menu").Hide();
			else if(Time > 300 && Time < 350)
				Page.GetFirstChild("menu").Hide();
			else if(Time > 400)
				Page.GetFirstChild("menu").Hide();
			else
				Page.GetFirstChild("menu").Show();
				
			if(Time > 400 && _Action != "") TriggerPageAction(_Action);
				
			return Time;
		}
		
		Real GetSliderValue() {
			return (Page.GetFirstChild("slider") as CMlFrame).GetFirstChild("button").RelativePosition_V3.Y / -88.0;
		}
		
		Integer GetDifficulty() {
			return MathLib::NearestInteger(GetSliderValue() * 4.0);
		}
		
		declare Text[] Maps;
	
		Void OnInit() {
			SoundHover = Audio.CreateSound("file://Media/Sounds/Hover.ogg");
			SoundClick = Audio.CreateSound("file://Media/Sounds/Click.ogg");
			SoundElectric = Audio.CreateSound("file://Media/Sounds/Electric.ogg");
			
			Maps.add("");
			
			for(i,1,15) {
				declare Number = "";
				if(i < 10) Number = "0"^i;
				else Number = i^"";
			
				Maps.add("");
				Maps[i] = "A"^Number;
			}
			
			TrackOfTheDayRequest = Http.CreateGet("http://trackmania.bigbang1112.eu/nadeoenvimix/trackoftheday.php");
		}
		
		Void OnStart() {
			StartTime = Now;
			Page.GetFirstChild("menu").DataAttributeSet("time",StartTime^"");
		}
		
		Void AnimateMaps(Integer _StartTime) {
			declare Time = _StartTime;
			
			((Page.GetFirstChild("selection") as CMlFrame).GetFirstChild("difficultyBar") as CMlQuad).BgColor = <1.0,1.0,1.0>;
			
			for(i,1,15) {
				declare Map = ((Page.GetFirstChild("selection") as CMlFrame).GetFirstChild("maps") as CMlFrame).Controls[i - 1];
				
				Map.RelativeScale = 0.75 + AnimLib::EaseOutCubic(Now - Time, 0.0, 1.0, 500) * .25;
				
				if(GetDifficulty() == 4 && i > 5) {
					Map.Hide();
				}
				else {
					Map.Show();
				
					foreach(Control,(Map as CMlFrame).Controls) {
						if(Control is CMlQuad)
							(Control as CMlQuad).Opacity = AnimLib::EaseOutCubic(Now - Time, 0.0, 1.0, 500);
						if(Control is CMlLabel) {
							(Control as CMlLabel).Opacity = AnimLib::EaseOutCubic(Now - Time, 0.0, 1.0, 500);
							(Control as CMlLabel).SetText(Maps[i]);
						}
					}
					Time+=20;
				}
			}
		}
		
		declare Integer LastDifficulty;
		declare Integer DifficultySwitchTime;
		
		Void OnLoop() {
			if(GetDifficulty() != LastDifficulty) {
				DifficultySwitchTime = Now;
				
				Audio.PlaySoundEvent(SoundHover, 1.0);
				
				for(i,1,15) {
					declare Number = "";
					if(i < 10) Number = "0"^i;
					else Number = i^"";
					
					declare Diff = GetDifficulty();
					
					switch(Diff) {
						case 0: { Maps[i] = "A"^Number; }
						case 1: { Maps[i] = "B"^Number; }
						case 2: { Maps[i] = "C"^Number; }
						case 3: { Maps[i] = "D"^Number; }
						case 4: { Maps[i] = "E"^Number; }
					}
				}
			}
			
			LastDifficulty = GetDifficulty();
			
			AnimateMaps(DifficultySwitchTime);
		
			if(TrackOfTheDayRequest != Null) {
				if(TrackOfTheDayRequest.IsCompleted) {
					if(TrackOfTheDayRequest.StatusCode == 200) {
						(((Page.GetFirstChild("buttonTrack") as CMlFrame).GetFirstChild("track") as CMlFrame).GetFirstChild("thumbnail") as CMlQuad).ChangeImageUrl("file://Media/Thumbnails/NoThumbnail.jpg");
					}
					else {
						(((Page.GetFirstChild("buttonTrack") as CMlFrame).GetFirstChild("track") as CMlFrame).GetFirstChild("thumbnail") as CMlQuad).ChangeImageUrl("file://Media/Thumbnails/Unknown.jpg");
					}
						
					TrackOfTheDayRequest = Null;
				}
			}
			
			declare Slider = (Page.GetFirstChild("slider") as CMlFrame);
			
			if(!MouseLeftButton) {
				Slider.DataAttributeSet("hold","false");
			}
			
			if(Slider.DataAttributeGet("hold") == "true") {
				Slider.GetFirstChild("button").RelativePosition_V3.Y = MathLib::Clamp(TextLib::ToReal(Slider.DataAttributeGet("pos")) + MouseY - TextLib::ToReal(Slider.DataAttributeGet("mouse_y")),-88.0,0.0);
			}
		
			if(Page.GetFirstChild("menu").DataAttributeGet("state") == "hidden") {
				HideMenu(TextLib::ToInteger(Page.GetFirstChild("menu").DataAttributeGet("time")),Page.GetFirstChild("menu").DataAttributeGet("action"));
			}
			else {
				ShowMenu(TextLib::ToInteger(Page.GetFirstChild("menu").DataAttributeGet("time")));
			}
		
			foreach(Button,(Page.GetFirstChild("buttons") as CMlFrame).Controls) {
				declare B <=> (Button as CMlFrame);
				
				declare Time = TextLib::ToInteger(B.DataAttributeGet("hover_time"));
				declare Value = AnimLib::EaseOutCubic(Now - Time, 0.0, 1.0, 200);
				
				if(B.DataAttributeGet("hover") == "true") {
					(B.GetFirstChild("button") as CMlQuad).BgColor = <Value,Value,Value>;
					(B.GetFirstChild("text") as CMlLabel).TextColor = <1.0-Value,1.0-Value,1.0-Value>;
				}
				else {
					(B.GetFirstChild("button") as CMlQuad).BgColor = <1.0-Value,1.0-Value,1.0-Value>;
					(B.GetFirstChild("text") as CMlLabel).TextColor = <Value,Value,Value>;
				}
				
				if(B.ControlId == "buttonTrack") {
					declare ValueTrack = AnimLib::EaseInOutSine(Now - Time, 0.0, 1.0, 500);
				
					if(B.DataAttributeGet("hover") == "true") {
						(B.GetFirstChild("track") as CMlFrame).RelativeScale = ValueTrack * 0.05 + 1;
						((B.GetFirstChild("track") as CMlFrame).GetFirstChild("name") as CMlLabel).Opacity = ValueTrack;
					}
					else {
						(B.GetFirstChild("track") as CMlFrame).RelativeScale = 1.05 - ValueTrack * 0.05;
						((B.GetFirstChild("track") as CMlFrame).GetFirstChild("name") as CMlLabel).Opacity = 1.0 - ValueTrack;
					}
				}
			}
			
			declare Button = ((Page.GetFirstChild("selection") as CMlFrame).GetFirstChild("slider") as CMlFrame);
			declare V = AnimLib::EaseOutCubic(Now - TextLib::ToInteger(Button.DataAttributeGet("hover_time")), 0.0, 1.0, 100) * 0.5 + 0.25;
			
			if(Button.DataAttributeGet("hover") == "true") {
				(Button.GetFirstChild("button") as CMlQuad).BgColor = <V,V,V>;
			}
			else {
				(Button.GetFirstChild("button") as CMlQuad).BgColor = <1.0-V,1.0-V,1.0-V>;
			}
		}
	
		Void OnEvent(CMlEvent _Event) {
			declare E <=> _Event;
			
			switch(E.Type) {
				case CMlEvent::Type::MouseOver: {
					declare Frame <=> E.Control.Parent;
					
					if(E.ControlId == "button") {
						Audio.PlaySoundEvent(SoundHover, 1.0);
						Frame.DataAttributeSet("hover","true");
						Frame.DataAttributeSet("hover_time",Now^"");
						Frame.DataAttributeSet("hover_in_value",(E.Control as CMlQuad).BgColor[0]^"");
					}
				}
				case CMlEvent::Type::MouseOut: {
					declare Frame <=> E.Control.Parent;
					
					if(E.ControlId == "button") {
						Frame.DataAttributeSet("hover","false");
						Frame.DataAttributeSet("hover_time",Now^"");
						Frame.DataAttributeSet("hover_out_value",(E.Control as CMlQuad).BgColor[0]^"");
					}
				}
				case CMlEvent::Type::MouseClick: {
					if(E.Control.Parent.ControlId == "buttonPlay") {
						Audio.PlaySoundEvent(SoundClick, 1.0);
						Audio.PlaySoundEvent(SoundElectric, 1.0);
						Page.GetFirstChild("menu").DataAttributeSet("state","hidden");
						Page.GetFirstChild("menu").DataAttributeSet("time",Now^"");
						Page.GetFirstChild("menu").DataAttributeSet("action","");
			
						(Page.GetFirstChild("menu") as CMlFrame).GetFirstChild("block").Show();
						Page.GetFirstChild("selection").Show();
					}
					if(E.Control.Parent.ControlId == "buttonProfile") {
						Audio.PlaySoundEvent(SoundClick, 1.0);
						Audio.PlaySoundEvent(SoundElectric, 1.0);
						Page.GetFirstChild("menu").DataAttributeSet("state","hidden");
						Page.GetFirstChild("menu").DataAttributeSet("time",Now^"");
						Page.GetFirstChild("menu").DataAttributeSet("action","menu_profile");
					}
					if(E.Control.Parent.ControlId == "buttonExit") {
						Audio.PlaySoundEvent(SoundClick, 1.0);
						Audio.PlaySoundEvent(SoundElectric, 1.0);
						Page.GetFirstChild("menu").DataAttributeSet("state","hidden");
						Page.GetFirstChild("menu").DataAttributeSet("time",Now^"");
						Page.GetFirstChild("menu").DataAttributeSet("action","quit");
					}
					
					if(E.Control.Parent.ControlId == "buttonBack") {
						Audio.PlaySoundEvent(SoundClick, 1.0);
						Page.GetFirstChild("menu").DataAttributeSet("state","shown");
						Page.GetFirstChild("menu").DataAttributeSet("time",Now^"");
						Page.GetFirstChild("menu").DataAttributeSet("action","");
						
						(Page.GetFirstChild("menu") as CMlFrame).GetFirstChild("block").Hide();
						Page.GetFirstChild("selection").Hide();
					}
					
					if(E.Control.Parent.ControlId == "slider") {
						Audio.PlaySoundEvent(SoundClick, 1.0);
						E.Control.Parent.DataAttributeSet("hold","true");
						E.Control.Parent.DataAttributeSet("mouse_y",MouseY^"");
						E.Control.Parent.DataAttributeSet("pos",E.Control.RelativePosition_V3.Y^"");
					}
				}
			}
		}
		
		main() {		
			OnInit();
			OnStart();
		
			while(True) {
				OnLoop();
			
				foreach(Event,PendingEvents) {
					OnEvent(Event);
				}
			
				yield;
			}
		}
	-->
	</script>
</manialink>